# セキュリティポリシー (Security Policy)

日本株ウォッチドッグは個人の投資データを扱う重要なアプリケーションです。セキュリティを最優先に考えており、ユーザーの財務情報とプライバシーを保護することをお約束します。

## 🛡️ セキュリティ原則

### データプライバシー
- **ローカルストレージ**: 全ての投資データはローカルのSQLiteデータベースに保存
- **クラウド非依存**: 個人の投資情報はクラウドに送信されません
- **暗号化推奨**: 機密性の高いデバイスでは全体の暗号化を推奨

### API認証情報管理
- **環境変数**: APIキーは`.env`ファイルで管理
- **Git除外**: 認証情報は`.gitignore`で自動除外
- **最小権限**: 必要最小限の権限のみ使用

### ネットワークセキュリティ
- **HTTPS通信**: 全てのAPI通信はHTTPS経由
- **証明書検証**: SSL証明書の正当性を検証
- **タイムアウト**: 適切なタイムアウト設定でDoS攻撃を防止

## 🔒 サポート対象バージョン

| バージョン | サポート状況 |
| --------- | ----------- |
| 1.4.x     | ✅ フルサポート |
| 1.3.x     | ✅ セキュリティパッチのみ |
| 1.2.x     | ❌ サポート終了 |
| < 1.2     | ❌ サポート終了 |

## 🚨 脆弱性の報告

### 報告手順
1. **即座に使用を停止**: 重大な脆弱性を発見した場合
2. **非公開で報告**: 以下の方法で報告してください
3. **詳細情報を提供**: 再現手順と影響範囲を含める

### 報告方法
- **推奨**: GitHubのSecurity Advisoryを使用
- **緊急**: email: security@example.com (セキュリティ専用)
- **一般**: 通常のIssueとして報告（軽微なもののみ）

### 報告すべき内容
- 脆弱性の詳細な説明
- 影響を受けるバージョン
- 再現手順（可能であれば）
- 攻撃シナリオ（該当する場合）
- 推奨される対策

## ⏱️ 対応スケジュール

| 重要度 | 初期応答 | 修正リリース |
|--------|----------|-------------|
| 緊急（Critical） | 24時間以内 | 7日以内 |
| 高（High） | 3日以内 | 30日以内 |
| 中（Medium） | 7日以内 | 90日以内 |
| 低（Low） | 14日以内 | 次回リリース |

## 🛠️ セキュリティ機能

### データ保護
```python
# 環境変数による認証情報管理
JQUANTS_REFRESH_TOKEN=your_token_here
GMAIL_APP_PASSWORD=your_app_password

# データベース暗号化（推奨）
# ディスク全体暗号化: BitLocker (Windows) / FileVault (macOS) / LUKS (Linux)
```

### 通信セキュリティ
- **J Quants API**: HTTPS + OAuth認証
- **Yahoo Finance**: HTTPS通信
- **Email**: STARTTLS暗号化
- **Discord/LINE**: Webhook認証

### ログセキュリティ
```python
# 機密情報のログ出力を防止
# APIキー、パスワード等は***でマスク
# 個人の取引履歴は匿名化
```

## 🔍 セキュリティベストプラクティス

### ユーザー向け推奨事項
1. **APIキー管理**
   - 定期的なAPIキーローテーション
   - 不要になったキーの即座な削除
   - APIキーの共有禁止

2. **システムセキュリティ**
   - OSとセキュリティパッチの最新化
   - アンチウイルスソフトの使用
   - ファイアウォールの適切な設定

3. **データバックアップ**
   - 定期的なデータバックアップ
   - バックアップの暗号化
   - 安全な場所への保管

### 開発者向け推奨事項
1. **コードセキュリティ**
   ```python
   # 機密情報のハードコーディング禁止
   api_key = os.getenv('API_KEY')  # ✅ 正しい
   api_key = "your_api_key_here"   # ❌ 危険
   ```

2. **依存関係管理**
   - 定期的な依存関係の更新
   - 脆弱性スキャンの実行
   - 信頼できるパッケージのみ使用

3. **入力検証**
   ```python
   # ユーザー入力の検証
   def validate_stock_symbol(symbol: str) -> bool:
       return symbol.isalnum() and len(symbol) <= 10
   ```

## 📋 セキュリティ監査

### 自動セキュリティチェック
- **依存関係スキャン**: pip-audit
- **コード分析**: bandit
- **設定チェック**: カスタムスクリプト

### 手動セキュリティレビュー
- 新機能のセキュリティ影響評価
- APIセキュリティレビュー
- データフロー分析

## 🚫 既知の制限事項

### 技術的制限
- **平文ストレージ**: データベースは平文で保存（ディスク暗号化推奨）
- **メモリ上の機密情報**: 実行中はメモリに一時的に保存
- **ローカル攻撃**: 物理アクセスがある攻撃者に対する保護は限定的

### 免責事項
⚠️ **重要**: このアプリケーションは投資判断の参考情報を提供するものであり、セキュリティ100%を保証するものではありません。

- 投資は自己責任で行ってください
- 重要な投資判断は複数の情報源で確認してください
- システムの脆弱性による損失については責任を負いかねます

## 📞 緊急時の連絡先

### セキュリティインシデント
- **GitHub Security Advisory**: 推奨方法
- **Email**: security@example.com
- **Issue**: 軽微な問題のみ

### 一般的なセキュリティ質問
- **GitHub Discussion**: コミュニティでの議論
- **Issue**: 機能改善提案
- **Documentation**: よくある質問

---

**重要**: セキュリティは継続的なプロセスです。問題を発見した場合は、躊躇せずに報告してください。皆様のご協力により、より安全なツールを提供できます。