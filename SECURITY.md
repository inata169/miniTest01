# セキュリティポリシー (Security Policy)

日本株ウォッチドッグは個人開発の無料オープンソースツールです。投資データのセキュリティを重視し、可能な限りユーザーのプライバシー保護に努めています。

## 🛡️ セキュリティ原則

### データプライバシー
- **ローカルストレージ**: 全ての投資データはローカルのSQLiteデータベースに保存
- **クラウド非依存**: 個人の投資情報はクラウドに送信されません
- **暗号化推奨**: 機密性の高いデバイスでは全体の暗号化を推奨

### API認証情報管理
- **環境変数**: APIキーは`.env`ファイルで管理
- **Git除外**: 認証情報は`.gitignore`で自動除外
- **最小権限**: 必要最小限の権限のみ使用

### ネットワークセキュリティ
- **HTTPS通信**: 全てのAPI通信はHTTPS経由
- **証明書検証**: SSL証明書の正当性を検証
- **タイムアウト**: 適切なタイムアウト設定でDoS攻撃を防止

## 🔒 サポート対象バージョン

| バージョン | サポート状況 |
| --------- | ----------- |
| 1.4.x     | ✅ フルサポート |
| 1.3.x     | ✅ セキュリティパッチのみ |
| 1.2.x     | ❌ サポート終了 |
| < 1.2     | ❌ サポート終了 |

## 🚨 脆弱性の報告

### 報告手順
1. **即座に使用を停止**: 重大な脆弱性を発見した場合
2. **非公開で報告**: 以下の方法で報告してください
3. **詳細情報を提供**: 再現手順と影響範囲を含める

### 報告方法
- **推奨**: GitHubのIssueとして報告
- **一般**: プルリクエストとして修正提案
- **軽微な問題**: Discussionでの議論

### 報告すべき内容
- 脆弱性の詳細な説明
- 影響を受けるバージョン
- 再現手順（可能であれば）
- 攻撃シナリオ（該当する場合）
- 推奨される対策

## ⏱️ 対応スケジュール

| 重要度 | 初期応答 | 修正リリース |
|--------|----------|-------------|
| 緊急（Critical） | 可能な限り迅速に | 1-2週間程度 |
| 高（High） | 数日以内 | 1ヶ月程度 |
| 中（Medium） | 1週間程度 | 次回アップデート |
| 低（Low） | 次回確認時 | 次回リリース |

※個人開発のため、対応時間は状況により変動する場合があります。

## 🛠️ セキュリティ機能

### データ保護
```python
# 環境変数による認証情報管理
JQUANTS_REFRESH_TOKEN=your_token_here
GMAIL_APP_PASSWORD=your_app_password

# データベース暗号化（推奨）
# ディスク全体暗号化: BitLocker (Windows) / FileVault (macOS) / LUKS (Linux)
```

### 通信セキュリティ
- **J Quants API**: HTTPS + OAuth認証
- **Yahoo Finance**: HTTPS通信
- **Email**: STARTTLS暗号化
- **Discord/LINE**: Webhook認証

### ログセキュリティ
```python
# 機密情報のログ出力を防止
# APIキー、パスワード等は***でマスク
# 個人の取引履歴は匿名化
```

## 🔍 セキュリティベストプラクティス

### ユーザー向け推奨事項
1. **APIキー管理**
   - 定期的なAPIキーローテーション
   - 不要になったキーの即座な削除
   - APIキーの共有禁止

2. **システムセキュリティ**
   - OSとセキュリティパッチの最新化
   - アンチウイルスソフトの使用
   - ファイアウォールの適切な設定

3. **データバックアップ**
   - 定期的なデータバックアップ
   - バックアップの暗号化
   - 安全な場所への保管

### 開発者向け推奨事項
1. **コードセキュリティ**
   ```python
   # 機密情報のハードコーディング禁止
   api_key = os.getenv('API_KEY')  # ✅ 正しい
   api_key = "your_api_key_here"   # ❌ 危険
   ```

2. **依存関係管理**
   - 定期的な依存関係の更新
   - 脆弱性スキャンの実行
   - 信頼できるパッケージのみ使用

3. **入力検証**
   ```python
   # ユーザー入力の検証
   def validate_stock_symbol(symbol: str) -> bool:
       return symbol.isalnum() and len(symbol) <= 10
   ```

## 📋 セキュリティ監査

### 自動セキュリティチェック
- **依存関係スキャン**: pip-audit
- **コード分析**: bandit
- **設定チェック**: カスタムスクリプト

### 手動セキュリティレビュー
- 新機能のセキュリティ影響評価
- APIセキュリティレビュー
- データフロー分析

## 🚫 既知の制限事項

### 技術的制限
- **平文ストレージ**: データベースは平文で保存（ディスク暗号化推奨）
- **メモリ上の機密情報**: 実行中はメモリに一時的に保存
- **ローカル攻撃**: 物理アクセスがある攻撃者に対する保護は限定的

### 免責事項
⚠️ **重要**: このアプリケーションは個人が開発・提供する無料ツールです。

- **投資判断**: 投資は自己責任で行ってください
- **セキュリティ**: 完全なセキュリティを保証するものではありません
- **損失責任**: システムの脆弱性や不具合による損失については責任を負いかねます
- **利益相反**: このツールは無料提供のため、開発者に金銭的利益はありません

## 📞 連絡方法

### セキュリティ問題の報告
- **GitHub Issue**: 最も確実な方法
- **GitHub Discussion**: 一般的な質問・議論
- **Pull Request**: 修正提案

### サポート範囲
個人開発のため、以下の点をご理解ください：
- 対応は最善努力ベースとなります
- 緊急対応や24時間サポートは提供できません
- 企業レベルのセキュリティ監査は実施していません

---

**重要**: セキュリティは継続的なプロセスです。問題を発見した場合は、躊躇せずに報告してください。皆様のご協力により、より安全なツールを提供できます。