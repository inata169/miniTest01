# Gmail通知設定ガイド - セキュリティ重視版

## 🔒 なぜセキュリティが重要なのか？

Gmail通知を使うには、アプリがあなたのGmailアカウントにアクセスする必要があります。
しかし、普通のパスワードを使うのは**非常に危険**です。

### ❌ 絶対にやってはいけないこと
- 普通のGmailパスワードをアプリに入力する
- パスワードをテキストファイルに保存する
- 他人にパスワードを教える

### ✅ 安全な方法
- **アプリパスワード**という特別なパスワードを使う
- **環境変数**という安全な場所に保存する
- **2段階認証**を必ず有効にする

---

## 📝 設定手順（初心者向け）

### ステップ1: 2段階認証を有効にする

**これは絶対に必要です。セキュリティの基本です。**

1. **Googleアカウント管理画面を開く**
   - ブラウザで [myaccount.google.com](https://myaccount.google.com) にアクセス
   - Googleアカウントでログイン

2. **セキュリティ設定を開く**
   - 左メニューの「セキュリティ」をクリック
   - 「Googleへのログイン」セクションを探す

3. **2段階認証を設定**
   - 「2段階認証プロセス」をクリック
   - 指示に従って設定（SMSまたは認証アプリ）
   - **必ず最後まで完了してください**

### ステップ2: アプリパスワードを作成する

**アプリパスワードは、あなたの本当のパスワードより安全です。**

1. **アプリパスワード画面を開く**
   - [passwords.google.com](https://passwords.google.com/options/apppasswords) にアクセス
   - または、Googleアカウント → セキュリティ → 「アプリパスワード」

2. **新しいアプリパスワードを作成**
   - 「アプリを選択」→「メール」を選択
   - 「デバイスを選択」→「Windowsコンピュータ」を選択
   - 「生成」ボタンをクリック

3. **生成されたパスワードをコピー**
   - 16文字のパスワードが表示されます（例：`abcd efgh ijkl mnop`）
   - **このパスワードをコピーしてください**
   - **二度と表示されないので注意！**

### ステップ3: 環境変数に安全に保存する

**環境変数は、パスワードを安全に保存する方法です。**

#### Windows での設定方法

1. **環境変数設定画面を開く**
   ```
   方法1: スタートメニューで「環境変数」と検索
   方法2: Win + R → 「sysdm.cpl」→ 詳細設定 → 環境変数
   ```

2. **新しい環境変数を作成**
   - 「新規」ボタンをクリック
   - **変数名**: `GMAIL_USERNAME`
   - **変数値**: あなたのGmailアドレス（例：`your_email@gmail.com`）
   - 「OK」をクリック

3. **アプリパスワード用の環境変数を作成**
   - 再び「新規」ボタンをクリック
   - **変数名**: `GMAIL_APP_PASSWORD`
   - **変数値**: ステップ2でコピーしたアプリパスワード
   - 「OK」をクリック

4. **設定を保存**
   - 全ての画面で「OK」をクリック
   - **パソコンを再起動**（重要！）

#### 設定確認方法

パソコン再起動後、PowerShellで確認：

```powershell
# PowerShellを開いて以下を実行
echo $env:GMAIL_USERNAME
echo $env:GMAIL_APP_PASSWORD
```

正しく設定されていれば、あなたのメールアドレスとアプリパスワードが表示されます。

---

## ⚙️ アプリ側の設定

### 設定ファイルを編集する

1. **設定ファイルを開く**
   - `config/settings.json` をテキストエディタで開く

2. **通知設定を変更**
   ```json
   {
     "notifications": {
       "email": {
         "enabled": true,
         "smtp_server": "smtp.gmail.com",
         "smtp_port": 587,
         "username": "",
         "password": "",
         "recipients": ["your_email@gmail.com"]
       }
     }
   }
   ```

3. **重要なポイント**
   - `username` と `password` は**空のまま**にしてください
   - アプリが環境変数から自動的に読み込みます
   - `recipients` にはアラートを受け取りたいメールアドレスを入力

---

## 🔧 トラブルシューティング

### よくある問題と解決方法

#### 1. 「アプリパスワード」が見つからない
```
原因: 2段階認証が無効になっている
解決方法: ステップ1を確実に完了してください
```

#### 2. 環境変数が設定できない
```
原因: 管理者権限が必要な場合があります
解決方法: 
1. 管理者としてコマンドプロンプトを実行
2. 以下のコマンドを実行
   setx GMAIL_USERNAME "your_email@gmail.com" /M
   setx GMAIL_APP_PASSWORD "your_app_password" /M
```

#### 3. メール送信でエラーが出る
```
原因1: 環境変数の設定ミス
確認方法: PowerShellで echo $env:GMAIL_USERNAME を実行

原因2: アプリパスワードの間違い
解決方法: 新しいアプリパスワードを作成し直す

原因3: セキュリティソフトがブロック
解決方法: ファイアウォール設定を確認
```

#### 4. 「Gmail_USERNAME が見つかりません」エラー
```
原因: パソコンを再起動していない
解決方法: パソコンを再起動してアプリを再実行
```

---

## 🛡️ セキュリティのベストプラクティス

### ✅ 推奨する安全な使い方

1. **定期的なパスワード変更**
   - 6ヶ月に1回はアプリパスワードを新しく作成
   - 古いアプリパスワードは削除

2. **アクセス監視**
   - Googleアカウントの「最近のアクティビティ」を定期確認
   - 不審なアクセスがないかチェック

3. **端末管理**
   - 使わなくなったパソコンからは環境変数を削除
   - 他人と共有するパソコンでは使用しない

### ❌ 避けるべき危険な行為

1. **パスワードの平文保存**
   ```
   ❌ テキストファイルに保存
   ❌ Excelファイルに保存
   ❌ デスクトップに付箋で貼る
   ```

2. **パスワードの共有**
   ```
   ❌ メールで送信
   ❌ チャットで送信
   ❌ 他人に教える
   ```

3. **不適切な場所での設定**
   ```
   ❌ インターネットカフェ
   ❌ 会社の共有PC
   ❌ 公共Wi-Fi環境
   ```

---

## 🔄 簡単設定オプション

### デスクトップ通知のみを使う（推奨）

Gmail設定が複雑に感じる場合は、デスクトップ通知のみの使用を推奨します。

**メリット:**
- パスワード設定不要
- 即座に設定完了
- セキュリティリスクなし

**設定方法:**
```json
{
  "notifications": {
    "email": {
      "enabled": false
    },
    "desktop": {
      "enabled": true
    }
  }
}
```

---

## 📞 困ったときは

### サポート情報

1. **公式ヘルプ**
   - [Googleアカウントヘルプ](https://support.google.com/accounts)
   - [2段階認証について](https://support.google.com/accounts/answer/185839)

2. **このアプリのサポート**
   - GitHub Issues で質問可能
   - `config/settings.json` の設定例を参照

3. **緊急時の対処**
   - アプリパスワードが漏洩した場合：即座に削除して新しく作成
   - 不審なアクセスを発見した場合：Googleアカウントのパスワードを変更

---

## 💡 まとめ

Gmail通知の設定は複雑に見えますが、**セキュリティを守るため**です。

**覚えておくべき重要なポイント:**

1. 🔐 **2段階認証は必須** - これがないとアプリパスワードが作れません
2. 🔑 **アプリパスワードを使う** - 普通のパスワードは絶対に使わない
3. 💾 **環境変数で保存** - 設定ファイルに直接書かない
4. 🔄 **定期的な更新** - セキュリティ維持のため定期的にパスワード変更

**初心者の方へ:**
難しく感じたら、まずはデスクトップ通知から始めてください。
慣れてからGmail通知に挑戦しても全く問題ありません。

**セキュリティは面倒ですが、あなたの大切な情報を守るためです。**
手順をしっかり守って、安全にアプリを使いましょう！